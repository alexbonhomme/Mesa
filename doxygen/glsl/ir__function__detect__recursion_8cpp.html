<html>
<head>
<title>Mesa Source Code Documentation</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head>
<body>
<div class="qindex">
<a class="qindex" href="../main/index.html">core</a> |
<a class="qindex" href="../glapi/index.html">glapi</a> |
<a class="qindex" href="../glsl/index.html">glsl</a> |
<a class="qindex" href="../vbo/index.html">vbo</a> |
<a class="qindex" href="../math/index.html">math</a> |
<a class="qindex" href="../shader/index.html">shader</a> |
<a class="qindex" href="../swrast/index.html">swrast</a> |
<a class="qindex" href="../swrast_setup/index.html">swrast_setup</a> |
<a class="qindex" href="../tnl/index.html">tnl</a> |
<a class="qindex" href="../tnl_dd/index.html">tnl_dd</a> |
<a class="qindex" href="../gbm/index.html">gbm</a>
</div>
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_9d873dbfec6053c8a46a8bdca18df976.html">glsl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ir_function_detect_recursion.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Determine whether a shader contains static recursion.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;main/core.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="ir_8h.html">ir.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="glsl__parser__extras_8h.html">glsl_parser_extras.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="linker_8h.html">linker.h</a>&quot;</code><br/>
<code>#include &quot;program/hash_table.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="program_8h.html">program.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ir_function_detect_recursion.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="ir__function__detect__recursion_8cpp__incl.png" border="0" usemap="#ir__function__detect__recursion_8cpp" alt=""/></div>
<map name="ir__function__detect__recursion_8cpp" id="ir__function__detect__recursion_8cpp">
<area shape="rect" id="node5" href="ir_8h.html" title="ir.h" alt="" coords="409,96,449,123"/><area shape="rect" id="node39" href="glsl__parser__extras_8h.html" title="glsl_parser_extras.h" alt="" coords="524,96,663,123"/><area shape="rect" id="node41" href="linker_8h.html" title="linker.h" alt="" coords="687,96,751,123"/><area shape="rect" id="node45" href="program_8h.html" title="program.h" alt="" coords="945,96,1025,123"/><area shape="rect" id="node11" href="ralloc_8h.html" title="ralloc: a recursive memory allocator" alt="" coords="245,245,309,272"/><area shape="rect" id="node21" href="glsl__types_8h.html" title="glsl_types.h" alt="" coords="431,171,523,197"/><area shape="rect" id="node29" href="list_8h.html" title="Doubly&#45;linked list abstract container type." alt="" coords="356,171,407,197"/><area shape="rect" id="node34" href="ir__visitor_8h.html" title="ir_visitor.h" alt="" coords="599,171,681,197"/><area shape="rect" id="node36" href="ir__hierarchical__visitor_8h.html" title="ir_hierarchical_visitor.h" alt="" coords="705,171,860,197"/></map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcall__node.html">call_node</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfunction.html">function</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhas__recursion__visitor.html">has_recursion_visitor</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad2bc04668112aea0e93e2d8c3e9322f8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ir__function__detect__recursion_8cpp.html#ad2bc04668112aea0e93e2d8c3e9322f8">destroy_links</a> (<a class="el" href="structexec__list.html">exec_list</a> *list, <a class="el" href="classfunction.html">function</a> *f)</td></tr>
<tr class="separator:ad2bc04668112aea0e93e2d8c3e9322f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd30bc448d1477885f3b51087d3a454c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ir__function__detect__recursion_8cpp.html#abd30bc448d1477885f3b51087d3a454c">remove_unlinked_functions</a> (const void *key, void *data, void *closure)</td></tr>
<tr class="memdesc:abd30bc448d1477885f3b51087d3a454c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a function if it has either no in or no out links.  <a href="#abd30bc448d1477885f3b51087d3a454c">More...</a><br/></td></tr>
<tr class="separator:abd30bc448d1477885f3b51087d3a454c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a236f31245c21881743ef08c94fcaecba"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ir__function__detect__recursion_8cpp.html#a236f31245c21881743ef08c94fcaecba">emit_errors_unlinked</a> (const void *key, void *data, void *closure)</td></tr>
<tr class="separator:a236f31245c21881743ef08c94fcaecba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a70cd7f63f2d706681309c9fb0c0558"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ir__function__detect__recursion_8cpp.html#a4a70cd7f63f2d706681309c9fb0c0558">emit_errors_linked</a> (const void *key, void *data, void *closure)</td></tr>
<tr class="separator:a4a70cd7f63f2d706681309c9fb0c0558"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae739a048fdf6237296e7d702dec24a25"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ir__function__detect__recursion_8cpp.html#ae739a048fdf6237296e7d702dec24a25">detect_recursion_unlinked</a> (struct _mesa_glsl_parse_state *state, <a class="el" href="structexec__list.html">exec_list</a> *instructions)</td></tr>
<tr class="memdesc:ae739a048fdf6237296e7d702dec24a25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detect whether an unlinked shader contains static recursion.  <a href="#ae739a048fdf6237296e7d702dec24a25">More...</a><br/></td></tr>
<tr class="separator:ae739a048fdf6237296e7d702dec24a25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9003a506720cfb369d463b1e3031e69"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ir__function__detect__recursion_8cpp.html#ae9003a506720cfb369d463b1e3031e69">detect_recursion_linked</a> (struct gl_shader_program *prog, <a class="el" href="structexec__list.html">exec_list</a> *instructions)</td></tr>
<tr class="memdesc:ae9003a506720cfb369d463b1e3031e69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detect whether a linked shader contains static recursion.  <a href="#ae9003a506720cfb369d463b1e3031e69">More...</a><br/></td></tr>
<tr class="separator:ae9003a506720cfb369d463b1e3031e69"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Determine whether a shader contains static recursion. </p>
<p>Consider the (possibly disjoint) graph of function calls in a shader. If a program contains recursion, this graph will contain a cycle. If a function is part of a cycle, it will have a caller and it will have a callee (it calls another function).</p>
<p>To detect recursion, the function call graph is constructed. The graph is repeatedly reduced by removing any function that either has no callees (leaf functions) or has no caller. Eventually the only functions that remain will be the functions in the cycles.</p>
<p>The GLSL spec is a bit wishy-washy about recursion.</p>
<p>From page 39 (page 45 of the PDF) of the GLSL 1.10 spec: </p>
<pre class="fragment">"Behavior is undefined if recursion is used. Recursion means having any
function appearing more than once at any one time in the run-time stack
of function calls. That is, a function may not call itself either
directly or indirectly. Compilers may give diagnostic messages when
this is detectable at compile time, but not all such cases can be
detected at compile time."
</pre><p>From page 79 (page 85 of the PDF): </p>
<pre class="fragment">"22) Should recursion be supported?

 DISCUSSION: Probably not necessary, but another example of limiting
 the language based on how it would directly map to hardware. One
 thought is that recursion would benefit ray tracing shaders. On the
 other hand, many recursion operations can also be implemented with the
 user managing the recursion through arrays. RenderMan doesn't support
 recursion. This could be added at a later date, if it proved to be
 necessary.

 RESOLVED on September 10, 2002: Implementations are not required to
 support recursion.

 CLOSED on September 10, 2002."
</pre><p>From page 79 (page 85 of the PDF): </p>
<pre class="fragment">"56) Is it an error for an implementation to support recursion if the
specification says recursion is not supported?

ADDED on September 10, 2002.

DISCUSSION: This issues is related to Issue (22). If we say that
recursion (or some other piece of functionality) is not supported, is
it an error for an implementation to support it? Perhaps the
specification should remain silent on these kind of things so that they
could be gracefully added later as an extension or as part of the
standard.

RESOLUTION: Languages, in general, have programs that are not
well-formed in ways a compiler cannot detect. Portability is only
ensured for well-formed programs. Detecting recursion is an example of
this. The language will say a well-formed program may not recurse, but
compilers are not forced to detect that recursion may happen.

CLOSED: November 29, 2002."
</pre><p>In GLSL 1.10 the behavior of recursion is undefined. Compilers don't have to reject shaders (at compile-time or link-time) that contain recursion. Instead they could work, or crash, or kill a kitten.</p>
<p>From page 44 (page 50 of the PDF) of the GLSL 1.20 spec: </p>
<pre class="fragment">"Recursion is not allowed, not even statically. Static recursion is
present if the static function call graph of the program contains
cycles."
</pre><p>This langauge clears things up a bit, but it still leaves a lot of questions unanswered. </p>
<pre class="fragment">- Is the error generated at compile-time or link-time?

- Is it an error to have a recursive function that is never statically
  called by main or any function called directly or indirectly by main?
  Technically speaking, such a function is not in the "static function
  call graph of the program" at all.
</pre><dl class="bug"><dt><b><a class="el" href="bug.html#_bug000001">Bug:</a></b></dt><dd>If a shader has multiple cycles, this algorithm may erroneously complain about functions that aren't in any cycle, but are in the part of the call tree that connects them. For example, if the call graph consists of a cycle between A and B, and a cycle between D and E, and B also calls C which calls D, then this algorithm will report C as a function which "has
static recursion" even though it is not part of any cycle.</dd></dl>
<p>A better algorithm for cycle detection that doesn't have this drawback can be found here:</p>
<p><a href="http://en.wikipedia.org/wiki/Tarjan%E2%80%99s_strongly_connected_components_algorithm">http://en.wikipedia.org/wiki/Tarjan%E2%80%99s_strongly_connected_components_algorithm</a></p>
<dl class="section author"><dt>Author</dt><dd>Ian Romanick <a href="#" onclick="location.href='mai'+'lto:'+'ian'+'.d'+'.ro'+'ma'+'nic'+'k@'+'int'+'el'+'.co'+'m'; return false;">ian.d<span style="display: none;">.nosp@m.</span>.rom<span style="display: none;">.nosp@m.</span>anick<span style="display: none;">.nosp@m.</span>@int<span style="display: none;">.nosp@m.</span>el.co<span style="display: none;">.nosp@m.</span>m</a> </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ad2bc04668112aea0e93e2d8c3e9322f8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void destroy_links </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structexec__list.html">exec_list</a> *&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfunction.html">function</a> *&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>References <a class="el" href="list_8h.html#a4cb07bdb5e504012a4ca707128cb0d13">foreach_list_safe</a>, and <a class="el" href="structcall__node.html#a70f997b8666302f84a83b3d847a31d19">call_node::func</a>.</p>

<p>Referenced by <a class="el" href="ir__function__detect__recursion_8cpp.html#abd30bc448d1477885f3b51087d3a454c">remove_unlinked_functions()</a>.</p>

</div>
</div>
<a class="anchor" id="ae9003a506720cfb369d463b1e3031e69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void detect_recursion_linked </td>
          <td>(</td>
          <td class="paramtype">struct gl_shader_program *&#160;</td>
          <td class="paramname"><em>prog</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexec__list.html">exec_list</a> *&#160;</td>
          <td class="paramname"><em>instructions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Detect whether a linked shader contains static recursion. </p>
<p>If the list of instructions is determined to contain static recursion, <code>link_error_printf</code> will be called to emit error messages for each function that is in the recursion cycle. In addition, <code>gl_shader_program::LinkStatus</code> will be set to false. </p>

<p>References <a class="el" href="ir__function__detect__recursion_8cpp.html#a4a70cd7f63f2d706681309c9fb0c0558">emit_errors_linked()</a>, <a class="el" href="classhas__recursion__visitor.html#a1866415585295ea61bec644a28572a03">has_recursion_visitor::function_hash</a>, <a class="el" href="classhas__recursion__visitor.html#a80aa80ce8e88da6388c412ace69c6232">has_recursion_visitor::progress</a>, <a class="el" href="ir__function__detect__recursion_8cpp.html#abd30bc448d1477885f3b51087d3a454c">remove_unlinked_functions()</a>, and <a class="el" href="classir__hierarchical__visitor.html#a730b38bc0e9081b22c31690bd7e39f3a">ir_hierarchical_visitor::run()</a>.</p>

<p>Referenced by <a class="el" href="program_8h.html#afc0379dac600d4977ea2e7ae44096f1a">link_shaders()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ir__function__detect__recursion_8cpp_ae9003a506720cfb369d463b1e3031e69_cgraph.png" border="0" usemap="#ir__function__detect__recursion_8cpp_ae9003a506720cfb369d463b1e3031e69_cgraph" alt=""/></div>
<map name="ir__function__detect__recursion_8cpp_ae9003a506720cfb369d463b1e3031e69_cgraph" id="ir__function__detect__recursion_8cpp_ae9003a506720cfb369d463b1e3031e69_cgraph">
<area shape="rect" id="node3" href="ir__function__detect__recursion_8cpp.html#a4a70cd7f63f2d706681309c9fb0c0558" title="emit_errors_linked" alt="" coords="240,183,368,209"/><area shape="rect" id="node44" href="ir__function__detect__recursion_8cpp.html#abd30bc448d1477885f3b51087d3a454c" title="Remove a function if it has either no in or no out links." alt="" coords="214,259,394,285"/><area shape="rect" id="node48" href="classir__hierarchical__visitor.html#a730b38bc0e9081b22c31690bd7e39f3a" title="Utility function to process a linked list of instructions with a visitor." alt="" coords="219,309,389,336"/><area shape="rect" id="node5" href="ast__function_8cpp.html#a201de0e9a762b67e9b6d313add6c8cee" title="Generate a source prototype for a function signature." alt="" coords="451,81,565,108"/><area shape="rect" id="node35" href="linker_8cpp.html#af2ae63b42d06c5aeeced547b1568e917" title="linker_error" alt="" coords="465,157,551,184"/><area shape="rect" id="node37" href="ralloc_8c.html#a280f5ecb6525a10e479c0b7c4ff89690" title="Free a piece of ralloc&#45;managed memory." alt="" coords="467,208,549,235"/><area shape="rect" id="node7" href="ralloc_8c.html#a59d30deb8469f39591e3edb73c7b3709" title="ralloc_asprintf" alt="" coords="1069,5,1171,32"/><area shape="rect" id="node19" href="ralloc_8c.html#a6db914c76a6e476346878a922a7bccfd" title="ralloc_asprintf_append" alt="" coords="621,56,773,83"/><area shape="rect" id="node30" href="ralloc_8c.html#a81efd739143e83e06e3f6b3da7f943bf" title="Concatenate two strings, allocating the necessary space." alt="" coords="651,107,744,133"/><area shape="rect" id="node9" href="ralloc_8c.html#a06fbe0c25dc86de1f27c42e1d1c0dd74" title="Print to a string, given a va_list." alt="" coords="1259,5,1370,32"/><area shape="rect" id="node11" href="ralloc_8c.html#a0d69b86f0cf5203cc5bf729b0f171bbe" title="printf_length" alt="" coords="1419,56,1512,83"/><area shape="rect" id="node13" href="ralloc_8c.html#a03d668aa9fce8d82182c2bfbd3f2a4e3" title="Allocate memory chained off of the given context." alt="" coords="1423,5,1507,32"/><area shape="rect" id="node15" href="ralloc_8c.html#a0fc43c6a4cfbe7313285d0fd1d265e9c" title="get_header" alt="" coords="1561,107,1647,133"/><area shape="rect" id="node17" href="ralloc_8c.html#a903391903c44abede7014caadd9c0c43" title="add_child" alt="" coords="1565,5,1643,32"/><area shape="rect" id="node21" href="ralloc_8c.html#ae3bc4f24688f337ee843c8be6d7d4970" title="Append formatted text to the supplied string, given a va_list." alt="" coords="822,56,981,83"/><area shape="rect" id="node23" href="ralloc_8c.html#ab178df8162cda12a67ffeaf4c588da19" title="Rewrite the tail of an existing string, starting at a given index." alt="" coords="1030,56,1210,83"/><area shape="rect" id="node27" href="ralloc_8c.html#ab9a56787f0f0d1421c708a57383eae25" title="resize" alt="" coords="1286,107,1343,133"/><area shape="rect" id="node32" href="ralloc_8c.html#aafc50d975c2ed969ac72872a4be70144" title="cat" alt="" coords="881,107,921,133"/><area shape="rect" id="node40" href="ralloc_8c.html#aa9f5466d1f5d3f1d2e706fd1b7f46b0a" title="unlink_block" alt="" coords="650,208,745,235"/><area shape="rect" id="node42" href="ralloc_8c.html#a839faa4b9da078e336f8d5e6b211eb2c" title="unsafe_free" alt="" coords="652,259,743,285"/><area shape="rect" id="node46" href="ir__function__detect__recursion_8cpp.html#ad2bc04668112aea0e93e2d8c3e9322f8" title="destroy_links" alt="" coords="459,259,557,285"/><area shape="rect" id="node50" href="ir__hierarchical__visitor_8h.html#a3d916e3fe1319c5d975084a1c412aa37" title="Process a list of nodes using a hierarchical vistor." alt="" coords="443,309,573,336"/><area shape="rect" id="node52" href="classir__instruction.html#aa797356958ce35850f057499c48a572c" title="ir_instruction::accept" alt="" coords="626,309,769,336"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae739a048fdf6237296e7d702dec24a25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void detect_recursion_unlinked </td>
          <td>(</td>
          <td class="paramtype">struct _mesa_glsl_parse_state *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexec__list.html">exec_list</a> *&#160;</td>
          <td class="paramname"><em>instructions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Detect whether an unlinked shader contains static recursion. </p>
<p>If the list of instructions is determined to contain static recursion, <code>_mesa_glsl_error</code> will be called to emit error messages for each function that is in the recursion cycle. </p>

<p>References <a class="el" href="ir__function__detect__recursion_8cpp.html#a236f31245c21881743ef08c94fcaecba">emit_errors_unlinked()</a>, <a class="el" href="classhas__recursion__visitor.html#a1866415585295ea61bec644a28572a03">has_recursion_visitor::function_hash</a>, <a class="el" href="classhas__recursion__visitor.html#a80aa80ce8e88da6388c412ace69c6232">has_recursion_visitor::progress</a>, <a class="el" href="ir__function__detect__recursion_8cpp.html#abd30bc448d1477885f3b51087d3a454c">remove_unlinked_functions()</a>, and <a class="el" href="classir__hierarchical__visitor.html#a730b38bc0e9081b22c31690bd7e39f3a">ir_hierarchical_visitor::run()</a>.</p>

<p>Referenced by <a class="el" href="ast__to__hir_8cpp.html#a13a9b8c3eda8d5a30843e02410e656db">_mesa_ast_to_hir()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ir__function__detect__recursion_8cpp_ae739a048fdf6237296e7d702dec24a25_cgraph.png" border="0" usemap="#ir__function__detect__recursion_8cpp_ae739a048fdf6237296e7d702dec24a25_cgraph" alt=""/></div>
<map name="ir__function__detect__recursion_8cpp_ae739a048fdf6237296e7d702dec24a25_cgraph" id="ir__function__detect__recursion_8cpp_ae739a048fdf6237296e7d702dec24a25_cgraph">
<area shape="rect" id="node3" href="ir__function__detect__recursion_8cpp.html#a236f31245c21881743ef08c94fcaecba" title="emit_errors_unlinked" alt="" coords="246,210,389,237"/><area shape="rect" id="node51" href="ir__function__detect__recursion_8cpp.html#abd30bc448d1477885f3b51087d3a454c" title="Remove a function if it has either no in or no out links." alt="" coords="227,302,407,329"/><area shape="rect" id="node55" href="classir__hierarchical__visitor.html#a730b38bc0e9081b22c31690bd7e39f3a" title="Utility function to process a linked list of instructions with a visitor." alt="" coords="232,359,403,386"/><area shape="rect" id="node5" href="ast__function_8cpp.html#a201de0e9a762b67e9b6d313add6c8cee" title="Generate a source prototype for a function signature." alt="" coords="649,55,764,82"/><area shape="rect" id="node35" href="glsl__parser__extras_8cpp.html#a939bd788b8a9f1a21c9f2ff0dd5b3aaa" title="_mesa_glsl_error" alt="" coords="461,169,582,195"/><area shape="rect" id="node44" href="ralloc_8c.html#a280f5ecb6525a10e479c0b7c4ff89690" title="Free a piece of ralloc&#45;managed memory." alt="" coords="480,251,563,278"/><area shape="rect" id="node7" href="ralloc_8c.html#a59d30deb8469f39591e3edb73c7b3709" title="ralloc_asprintf" alt="" coords="1274,10,1377,37"/><area shape="rect" id="node19" href="ralloc_8c.html#a6db914c76a6e476346878a922a7bccfd" title="ralloc_asprintf_append" alt="" coords="827,35,979,62"/><area shape="rect" id="node30" href="ralloc_8c.html#a81efd739143e83e06e3f6b3da7f943bf" title="Concatenate two strings, allocating the necessary space." alt="" coords="856,137,949,163"/><area shape="rect" id="node9" href="ralloc_8c.html#a06fbe0c25dc86de1f27c42e1d1c0dd74" title="Print to a string, given a va_list." alt="" coords="1465,35,1575,62"/><area shape="rect" id="node11" href="ralloc_8c.html#a0d69b86f0cf5203cc5bf729b0f171bbe" title="printf_length" alt="" coords="1624,86,1717,113"/><area shape="rect" id="node13" href="ralloc_8c.html#a03d668aa9fce8d82182c2bfbd3f2a4e3" title="Allocate memory chained off of the given context." alt="" coords="1629,35,1713,62"/><area shape="rect" id="node15" href="ralloc_8c.html#a0fc43c6a4cfbe7313285d0fd1d265e9c" title="get_header" alt="" coords="1766,137,1853,163"/><area shape="rect" id="node17" href="ralloc_8c.html#a903391903c44abede7014caadd9c0c43" title="add_child" alt="" coords="1771,35,1848,62"/><area shape="rect" id="node21" href="ralloc_8c.html#ae3bc4f24688f337ee843c8be6d7d4970" title="Append formatted text to the supplied string, given a va_list." alt="" coords="1027,86,1186,113"/><area shape="rect" id="node23" href="ralloc_8c.html#ab178df8162cda12a67ffeaf4c588da19" title="Rewrite the tail of an existing string, starting at a given index." alt="" coords="1235,86,1415,113"/><area shape="rect" id="node27" href="ralloc_8c.html#ab9a56787f0f0d1421c708a57383eae25" title="resize" alt="" coords="1491,137,1549,163"/><area shape="rect" id="node32" href="ralloc_8c.html#aafc50d975c2ed969ac72872a4be70144" title="cat" alt="" coords="1087,137,1127,163"/><area shape="rect" id="node37" href="glsl__parser__extras_8cpp.html#aa25ddbf1acbfec0effb16f27e01ddc7c" title="_mesa_glsl_msg" alt="" coords="647,137,767,163"/><area shape="rect" id="node39" href="standalone__scaffolding_8cpp.html#ae0f2f300f0644093c2bb7dd4a0e4a328" title="_mesa_shader_debug" alt="" coords="828,187,977,214"/><area shape="rect" id="node47" href="ralloc_8c.html#aa9f5466d1f5d3f1d2e706fd1b7f46b0a" title="unlink_block" alt="" coords="659,289,754,315"/><area shape="rect" id="node49" href="ralloc_8c.html#a839faa4b9da078e336f8d5e6b211eb2c" title="unsafe_free" alt="" coords="661,339,752,366"/><area shape="rect" id="node53" href="ir__function__detect__recursion_8cpp.html#ad2bc04668112aea0e93e2d8c3e9322f8" title="destroy_links" alt="" coords="472,302,571,329"/><area shape="rect" id="node57" href="ir__hierarchical__visitor_8h.html#a3d916e3fe1319c5d975084a1c412aa37" title="Process a list of nodes using a hierarchical vistor." alt="" coords="456,365,587,391"/><area shape="rect" id="node59" href="classir__instruction.html#aa797356958ce35850f057499c48a572c" title="ir_instruction::accept" alt="" coords="635,390,778,417"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4a70cd7f63f2d706681309c9fb0c0558"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void emit_errors_linked </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>closure</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>References <a class="el" href="linker_8cpp.html#af2ae63b42d06c5aeeced547b1568e917">linker_error()</a>, <a class="el" href="ast__function_8cpp.html#a201de0e9a762b67e9b6d313add6c8cee">prototype_string()</a>, and <a class="el" href="ralloc_8c.html#a280f5ecb6525a10e479c0b7c4ff89690">ralloc_free()</a>.</p>

<p>Referenced by <a class="el" href="ir__function__detect__recursion_8cpp.html#ae9003a506720cfb369d463b1e3031e69">detect_recursion_linked()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ir__function__detect__recursion_8cpp_a4a70cd7f63f2d706681309c9fb0c0558_cgraph.png" border="0" usemap="#ir__function__detect__recursion_8cpp_a4a70cd7f63f2d706681309c9fb0c0558_cgraph" alt=""/></div>
<map name="ir__function__detect__recursion_8cpp_a4a70cd7f63f2d706681309c9fb0c0558_cgraph" id="ir__function__detect__recursion_8cpp_a4a70cd7f63f2d706681309c9fb0c0558_cgraph">
<area shape="rect" id="node3" href="linker_8cpp.html#af2ae63b42d06c5aeeced547b1568e917" title="linker_error" alt="" coords="195,31,282,57"/><area shape="rect" id="node5" href="ast__function_8cpp.html#a201de0e9a762b67e9b6d313add6c8cee" title="Generate a source prototype for a function signature." alt="" coords="181,81,296,108"/><area shape="rect" id="node35" href="ralloc_8c.html#a280f5ecb6525a10e479c0b7c4ff89690" title="Free a piece of ralloc&#45;managed memory." alt="" coords="197,183,280,209"/><area shape="rect" id="node7" href="ralloc_8c.html#a59d30deb8469f39591e3edb73c7b3709" title="ralloc_asprintf" alt="" coords="791,5,894,32"/><area shape="rect" id="node19" href="ralloc_8c.html#a6db914c76a6e476346878a922a7bccfd" title="ralloc_asprintf_append" alt="" coords="344,56,496,83"/><area shape="rect" id="node30" href="ralloc_8c.html#a81efd739143e83e06e3f6b3da7f943bf" title="Concatenate two strings, allocating the necessary space." alt="" coords="373,107,467,133"/><area shape="rect" id="node9" href="ralloc_8c.html#a06fbe0c25dc86de1f27c42e1d1c0dd74" title="Print to a string, given a va_list." alt="" coords="982,5,1093,32"/><area shape="rect" id="node11" href="ralloc_8c.html#a0d69b86f0cf5203cc5bf729b0f171bbe" title="printf_length" alt="" coords="1141,56,1235,83"/><area shape="rect" id="node13" href="ralloc_8c.html#a03d668aa9fce8d82182c2bfbd3f2a4e3" title="Allocate memory chained off of the given context." alt="" coords="1146,5,1230,32"/><area shape="rect" id="node15" href="ralloc_8c.html#a0fc43c6a4cfbe7313285d0fd1d265e9c" title="get_header" alt="" coords="1283,107,1370,133"/><area shape="rect" id="node17" href="ralloc_8c.html#a903391903c44abede7014caadd9c0c43" title="add_child" alt="" coords="1288,5,1365,32"/><area shape="rect" id="node21" href="ralloc_8c.html#ae3bc4f24688f337ee843c8be6d7d4970" title="Append formatted text to the supplied string, given a va_list." alt="" coords="545,56,703,83"/><area shape="rect" id="node23" href="ralloc_8c.html#ab178df8162cda12a67ffeaf4c588da19" title="Rewrite the tail of an existing string, starting at a given index." alt="" coords="753,56,933,83"/><area shape="rect" id="node27" href="ralloc_8c.html#ab9a56787f0f0d1421c708a57383eae25" title="resize" alt="" coords="1009,107,1066,133"/><area shape="rect" id="node32" href="ralloc_8c.html#aafc50d975c2ed969ac72872a4be70144" title="cat" alt="" coords="604,107,644,133"/><area shape="rect" id="node38" href="ralloc_8c.html#aa9f5466d1f5d3f1d2e706fd1b7f46b0a" title="unlink_block" alt="" coords="373,208,467,235"/><area shape="rect" id="node40" href="ralloc_8c.html#a839faa4b9da078e336f8d5e6b211eb2c" title="unsafe_free" alt="" coords="375,259,465,285"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a236f31245c21881743ef08c94fcaecba"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void emit_errors_unlinked </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>closure</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>References <a class="el" href="glsl__parser__extras_8cpp.html#a939bd788b8a9f1a21c9f2ff0dd5b3aaa">_mesa_glsl_error()</a>, <a class="el" href="ast__function_8cpp.html#a201de0e9a762b67e9b6d313add6c8cee">prototype_string()</a>, and <a class="el" href="ralloc_8c.html#a280f5ecb6525a10e479c0b7c4ff89690">ralloc_free()</a>.</p>

<p>Referenced by <a class="el" href="ir__function__detect__recursion_8cpp.html#ae739a048fdf6237296e7d702dec24a25">detect_recursion_unlinked()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ir__function__detect__recursion_8cpp_a236f31245c21881743ef08c94fcaecba_cgraph.png" border="0" usemap="#ir__function__detect__recursion_8cpp_a236f31245c21881743ef08c94fcaecba_cgraph" alt=""/></div>
<map name="ir__function__detect__recursion_8cpp_a236f31245c21881743ef08c94fcaecba_cgraph" id="ir__function__detect__recursion_8cpp_a236f31245c21881743ef08c94fcaecba_cgraph">
<area shape="rect" id="node3" href="glsl__parser__extras_8cpp.html#a939bd788b8a9f1a21c9f2ff0dd5b3aaa" title="_mesa_glsl_error" alt="" coords="198,107,319,133"/><area shape="rect" id="node35" href="ast__function_8cpp.html#a201de0e9a762b67e9b6d313add6c8cee" title="Generate a source prototype for a function signature." alt="" coords="371,157,485,184"/><area shape="rect" id="node42" href="ralloc_8c.html#a280f5ecb6525a10e479c0b7c4ff89690" title="Free a piece of ralloc&#45;managed memory." alt="" coords="217,284,300,311"/><area shape="rect" id="node5" href="glsl__parser__extras_8cpp.html#aa25ddbf1acbfec0effb16f27e01ddc7c" title="_mesa_glsl_msg" alt="" coords="368,107,488,133"/><area shape="rect" id="node7" href="standalone__scaffolding_8cpp.html#ae0f2f300f0644093c2bb7dd4a0e4a328" title="_mesa_shader_debug" alt="" coords="537,5,687,32"/><area shape="rect" id="node9" href="ralloc_8c.html#a6db914c76a6e476346878a922a7bccfd" title="ralloc_asprintf_append" alt="" coords="536,107,688,133"/><area shape="rect" id="node11" href="ralloc_8c.html#ae3bc4f24688f337ee843c8be6d7d4970" title="Append formatted text to the supplied string, given a va_list." alt="" coords="737,107,895,133"/><area shape="rect" id="node29" href="ralloc_8c.html#a81efd739143e83e06e3f6b3da7f943bf" title="Concatenate two strings, allocating the necessary space." alt="" coords="565,157,659,184"/><area shape="rect" id="node13" href="ralloc_8c.html#ab178df8162cda12a67ffeaf4c588da19" title="Rewrite the tail of an existing string, starting at a given index." alt="" coords="945,107,1125,133"/><area shape="rect" id="node15" href="ralloc_8c.html#a06fbe0c25dc86de1f27c42e1d1c0dd74" title="Print to a string, given a va_list." alt="" coords="1174,132,1285,159"/><area shape="rect" id="node17" href="ralloc_8c.html#a0d69b86f0cf5203cc5bf729b0f171bbe" title="printf_length" alt="" coords="1333,81,1427,108"/><area shape="rect" id="node26" href="ralloc_8c.html#ab9a56787f0f0d1421c708a57383eae25" title="resize" alt="" coords="1201,183,1258,209"/><area shape="rect" id="node19" href="ralloc_8c.html#a03d668aa9fce8d82182c2bfbd3f2a4e3" title="Allocate memory chained off of the given context." alt="" coords="1338,132,1422,159"/><area shape="rect" id="node21" href="ralloc_8c.html#a0fc43c6a4cfbe7313285d0fd1d265e9c" title="get_header" alt="" coords="1475,183,1562,209"/><area shape="rect" id="node23" href="ralloc_8c.html#a903391903c44abede7014caadd9c0c43" title="add_child" alt="" coords="1480,132,1557,159"/><area shape="rect" id="node31" href="ralloc_8c.html#aafc50d975c2ed969ac72872a4be70144" title="cat" alt="" coords="1015,157,1055,184"/><area shape="rect" id="node37" href="ralloc_8c.html#a59d30deb8469f39591e3edb73c7b3709" title="ralloc_asprintf" alt="" coords="765,208,867,235"/><area shape="rect" id="node45" href="ralloc_8c.html#aa9f5466d1f5d3f1d2e706fd1b7f46b0a" title="unlink_block" alt="" coords="381,309,475,336"/><area shape="rect" id="node47" href="ralloc_8c.html#a839faa4b9da078e336f8d5e6b211eb2c" title="unsafe_free" alt="" coords="383,360,473,387"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abd30bc448d1477885f3b51087d3a454c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void remove_unlinked_functions </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>closure</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Remove a function if it has either no in or no out links. </p>

<p>References <a class="el" href="classfunction.html#a0d537cd31077d33af133f5a696b9438d">function::callees</a>, <a class="el" href="classfunction.html#a401d9363eec40d776c93814cb30d334a">function::callers</a>, <a class="el" href="ir__function__detect__recursion_8cpp.html#ad2bc04668112aea0e93e2d8c3e9322f8">destroy_links()</a>, <a class="el" href="structcall__node.html#a70f997b8666302f84a83b3d847a31d19">call_node::func</a>, <a class="el" href="classhas__recursion__visitor.html#a1866415585295ea61bec644a28572a03">has_recursion_visitor::function_hash</a>, and <a class="el" href="classhas__recursion__visitor.html#a80aa80ce8e88da6388c412ace69c6232">has_recursion_visitor::progress</a>.</p>

<p>Referenced by <a class="el" href="ir__function__detect__recursion_8cpp.html#ae9003a506720cfb369d463b1e3031e69">detect_recursion_linked()</a>, and <a class="el" href="ir__function__detect__recursion_8cpp.html#ae739a048fdf6237296e7d702dec24a25">detect_recursion_unlinked()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ir__function__detect__recursion_8cpp_abd30bc448d1477885f3b51087d3a454c_cgraph.png" border="0" usemap="#ir__function__detect__recursion_8cpp_abd30bc448d1477885f3b51087d3a454c_cgraph" alt=""/></div>
<map name="ir__function__detect__recursion_8cpp_abd30bc448d1477885f3b51087d3a454c_cgraph" id="ir__function__detect__recursion_8cpp_abd30bc448d1477885f3b51087d3a454c_cgraph">
<area shape="rect" id="node3" href="ir__function__detect__recursion_8cpp.html#ad2bc04668112aea0e93e2d8c3e9322f8" title="destroy_links" alt="" coords="235,5,333,32"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
